/**
 * Bundled by jsDelivr using Rollup v2.79.2 and Terser v5.39.0.
 * Original file: /npm/markdown-it-attrs@4.3.1/index.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
var t={};function e(t){return t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}t.getAttrs=function(t,e,n){const i=/[^\t\n\f />"'=]/,r=[];let s="",l="",o=!0,c=!1;for(let a=e+n.leftDelimiter.length;a<t.length;a++){if(t.slice(a,a+n.rightDelimiter.length)===n.rightDelimiter){""!==s&&r.push([s,l]);break}const e=t.charAt(a);if("="===e&&o)o=!1;else if("."!==e||""!==s)if("#"!==e||""!==s)if('"'!==e||""!==l||c)if('"'===e&&c)c=!1;else if(" "!==e||c)o&&-1===e.search(i)||(o?s+=e:l+=e);else{if(""===s)continue;r.push([s,l]),s="",l="",o=!0}else c=!0;else s="id",o=!1;else"."===t.charAt(a+1)?(s="css-module",a+=1):s="class",o=!1}if(n.allowedAttributes&&n.allowedAttributes.length){const t=n.allowedAttributes;return r.filter((function(e){const n=e[0];return t.some((function(t){return n===t||t instanceof RegExp&&t.test(n)}))}))}return r},t.addAttrs=function(t,e){for(let n=0,i=t.length;n<i;++n){const i=t[n][0];"class"===i?e.attrJoin("class",t[n][1]):"css-module"===i?e.attrJoin("css-module",t[n][1]):e.attrPush(t[n])}return e},t.hasDelimiters=function(t,e){if(!t)throw new Error('Parameter `where` not passed. Should be "start", "end" or "only".');return function(n){const i=e.leftDelimiter.length+1+e.rightDelimiter.length;if(!n||"string"!=typeof n||n.length<i)return!1;let r,s,l,o;const c=i-e.rightDelimiter.length;switch(t){case"start":l=n.slice(0,e.leftDelimiter.length),r=l===e.leftDelimiter?0:-1,s=-1===r?-1:n.indexOf(e.rightDelimiter,c),o=n.charAt(s+e.rightDelimiter.length),o&&-1!==e.rightDelimiter.indexOf(o)&&(s=-1);break;case"end":r=n.lastIndexOf(e.leftDelimiter),s=-1===r?-1:n.indexOf(e.rightDelimiter,r+c),s=s===n.length-e.rightDelimiter.length?s:-1;break;case"only":l=n.slice(0,e.leftDelimiter.length),r=l===e.leftDelimiter?0:-1,l=n.slice(n.length-e.rightDelimiter.length),s=l===e.rightDelimiter?n.length-e.rightDelimiter.length:-1;break;default:throw new Error(`Unexpected case ${t}, expected 'start', 'end' or 'only'`)}return-1!==r&&-1!==s&&function(t){const n="."===t.charAt(e.leftDelimiter.length),r="#"===t.charAt(e.leftDelimiter.length);return n||r?t.length>=i+1:t.length>=i}(n.substring(r,s+e.rightDelimiter.length))}},t.removeDelimiter=function(t,n){const i=e(n.leftDelimiter),r=e(n.rightDelimiter),s=new RegExp("[ \\n]?"+i+"[^"+i+r+"]+"+r+"$"),l=t.search(s);return-1!==l?t.slice(0,l):t},t.escapeRegExp=e,t.getMatchingOpeningToken=function(t,e){if("softbreak"===t[e].type)return!1;if(0===t[e].nesting)return t[e];const n=t[e].level,i=t[e].type.replace("_close","_open");for(;e>=0;--e)if(t[e].type===i&&t[e].level===n)return t[e];return!1};const n=/[&<>"]/,i=/[&<>"]/g,r={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"};function s(t){return r[t]}t.escapeHtml=function(t){return n.test(t)?t.replace(i,s):t};const l=t;function o(t){return t.slice(-1)[0]}function c(t){t.hidden=!0,t.children&&t.children.forEach((t=>(t.content="",void c(t))))}const a=t=>{const e=new RegExp("^ {0,3}[-*_]{3,} ?"+l.escapeRegExp(t.leftDelimiter)+"[^"+l.escapeRegExp(t.rightDelimiter)+"]");return[{name:"fenced code blocks",tests:[{shift:0,block:!0,info:l.hasDelimiters("end",t)}],transform:(e,n)=>{const i=e[n],r=i.info.lastIndexOf(t.leftDelimiter),s=l.getAttrs(i.info,r,t);l.addAttrs(s,i),i.info=l.removeDelimiter(i.info,t)}},{name:"inline nesting 0",tests:[{shift:0,type:"inline",children:[{shift:-1,type:t=>"image"===t||"code_inline"===t},{shift:0,type:"text",content:l.hasDelimiters("start",t)}]}],transform:(e,n,i)=>{const r=e[n].children[i],s=r.content.indexOf(t.rightDelimiter),o=e[n].children[i-1],c=l.getAttrs(r.content,0,t);l.addAttrs(c,o),r.content.length===s+t.rightDelimiter.length?e[n].children.splice(i,1):r.content=r.content.slice(s+t.rightDelimiter.length)}},{name:"tables",tests:[{shift:0,type:"table_close"},{shift:1,type:"paragraph_open"},{shift:2,type:"inline",content:l.hasDelimiters("only",t)}],transform:(e,n)=>{const i=e[n+2],r=l.getMatchingOpeningToken(e,n),s=l.getAttrs(i.content,0,t);l.addAttrs(s,r),e.splice(n+1,3)}},{name:"tables thead metadata",tests:[{shift:0,type:"tr_close"},{shift:1,type:"thead_close"},{shift:2,type:"tbody_open"}],transform:(t,e)=>{const n=l.getMatchingOpeningToken(t,e),i=t[e-1];let r=0,s=e;for(;--s;){if(t[s]===n){t[s-1].meta=Object.assign({},t[s+2].meta,{colsnum:r});break}r+=(t[s].level===i.level&&t[s].type===i.type)|0}t[e+2].meta=Object.assign({},t[e+2].meta,{colsnum:r})}},{name:"tables tbody calculate",tests:[{shift:0,type:"tbody_close",hidden:!1}],transform:(t,e)=>{let n=e-2;for(;n>0&&"tbody_open"!==t[--n].type;);const i=t[n].meta.colsnum|0;if(i<2)return;const r=t[e].level+2;for(let s=n;s<e;s++){if(t[s].level>r)continue;const l=t[s],o=l.hidden?0:l.attrGet("rowspan")|0,a=l.hidden?0:l.attrGet("colspan")|0;if(o>1){let e=i-(a>0?a:1);for(let n=s,i=o;i>1;n++)"tr_open"==t[n].type&&(t[n].meta=Object.assign({},t[n].meta),t[n].meta&&t[n].meta.colsnum&&(e-=1),t[n].meta.colsnum=e,i--)}if("tr_open"==l.type&&l.meta&&l.meta.colsnum){const n=l.meta.colsnum;for(let i=s,r=0;i<e;i++){if("td_open"==t[i].type)r+=1;else if("tr_close"==t[i].type)break;r>n&&(t[i].hidden||c(t[i]))}}if(a>1){const r=[];let o=s+3,f=i;for(let e=s;e>n;e--){if("tr_open"==t[e].type){f=t[e].meta&&t[e].meta.colsnum||f;break}"td_open"===t[e].type&&r.unshift(e)}for(let n=s+2;n<e;n++){if("tr_close"==t[n].type){o=n;break}"td_open"==t[n].type&&r.push(n)}let h=f-r.indexOf(s);h=h>a?a:h,a>h&&l.attrSet("colspan",h+"");for(let e=r.slice(f+1-i-h)[0];e<o;e++)t[e].hidden||c(t[e])}}}},{name:"inline attributes",tests:[{shift:0,type:"inline",children:[{shift:-1,nesting:-1},{shift:0,type:"text",content:l.hasDelimiters("start",t)}]}],transform:(e,n,i)=>{const r=e[n].children[i],s=r.content,o=l.getAttrs(s,0,t),c=l.getMatchingOpeningToken(e[n].children,i-1);l.addAttrs(o,c),r.content=s.slice(s.indexOf(t.rightDelimiter)+t.rightDelimiter.length)}},{name:"list softbreak",tests:[{shift:-2,type:"list_item_open"},{shift:0,type:"inline",children:[{position:-2,type:"softbreak"},{position:-1,type:"text",content:l.hasDelimiters("only",t)}]}],transform:(e,n,i)=>{const r=e[n].children[i].content,s=l.getAttrs(r,0,t);let o=n-2;for(;e[o-1]&&"ordered_list_open"!==e[o-1].type&&"bullet_list_open"!==e[o-1].type;)o--;l.addAttrs(s,e[o-1]),e[n].children=e[n].children.slice(0,-2)}},{name:"list double softbreak",tests:[{shift:0,type:t=>"bullet_list_close"===t||"ordered_list_close"===t},{shift:1,type:"paragraph_open"},{shift:2,type:"inline",content:l.hasDelimiters("only",t),children:t=>1===t.length},{shift:3,type:"paragraph_close"}],transform:(e,n)=>{const i=e[n+2].content,r=l.getAttrs(i,0,t),s=l.getMatchingOpeningToken(e,n);l.addAttrs(r,s),e.splice(n+1,3)}},{name:"list item end",tests:[{shift:-2,type:"list_item_open"},{shift:0,type:"inline",children:[{position:-1,type:"text",content:l.hasDelimiters("end",t)}]}],transform:(e,n,i)=>{const r=e[n].children[i],s=r.content,c=l.getAttrs(s,s.lastIndexOf(t.leftDelimiter),t);l.addAttrs(c,e[n-2]);const a=s.slice(0,s.lastIndexOf(t.leftDelimiter));r.content=" "!==o(a)?a:a.slice(0,-1)}},{name:"\n{.a} softbreak then curly in start",tests:[{shift:0,type:"inline",children:[{position:-2,type:"softbreak"},{position:-1,type:"text",content:l.hasDelimiters("only",t)}]}],transform:(e,n,i)=>{const r=e[n].children[i],s=l.getAttrs(r.content,0,t);let o=n+1;for(;e[o+1]&&-1===e[o+1].nesting;)o++;const c=l.getMatchingOpeningToken(e,o);l.addAttrs(s,c),e[n].children=e[n].children.slice(0,-2)}},{name:"horizontal rule",tests:[{shift:0,type:"paragraph_open"},{shift:1,type:"inline",children:t=>1===t.length,content:t=>null!==t.match(e)},{shift:2,type:"paragraph_close"}],transform:(e,n)=>{const i=e[n];i.type="hr",i.tag="hr",i.nesting=0;const r=e[n+1].content,s=r.lastIndexOf(t.leftDelimiter),o=l.getAttrs(r,s,t);l.addAttrs(o,i),i.markup=r,e.splice(n+1,2)}},{name:"end of block",tests:[{shift:0,type:"inline",children:[{position:-1,content:l.hasDelimiters("end",t),type:t=>"code_inline"!==t&&"math_inline"!==t}]}],transform:(e,n,i)=>{const r=e[n].children[i],s=r.content,c=l.getAttrs(s,s.lastIndexOf(t.leftDelimiter),t);let a=n+1;do{if(e[a]&&-1===e[a].nesting)break}while(a++<e.length);const f=l.getMatchingOpeningToken(e,a);l.addAttrs(c,f);const h=s.slice(0,s.lastIndexOf(t.leftDelimiter));r.content=" "!==o(h)?h:h.slice(0,-1)}}]},f={leftDelimiter:"{",rightDelimiter:"}",allowedAttributes:[]};var h=function(t,e){let n=Object.assign({},f);n=Object.assign(n,e);const i=a(n);t.core.ruler.before("linkify","curly_attributes",(function(t){const e=t.tokens;for(let t=0;t<e.length;t++)for(let n=0;n<i.length;n++){const r=i[n];let s=null;if(r.tests.every((n=>{const i=p(e,t,n);return null!==i.j&&(s=i.j),i.match})))try{r.transform(e,t,s),"inline attributes"!==r.name&&"inline nesting 0"!==r.name||n--}catch(t){console.error(`markdown-it-attrs: Error in pattern '${r.name}': ${t.message}`),console.error(t.stack)}}}))};function p(t,e,n){const i={match:!1,j:null},r=void 0!==n.shift?e+n.shift:n.position;if(void 0!==n.shift&&r<0)return i;const s=(l=t,(o=r)>=0?l[o]:l[l.length+o]);var l,o;if(void 0===s)return i;for(const t of Object.keys(n))if("shift"!==t&&"position"!==t){if(void 0===s[t])return i;if("children"===t&&m(n.children)){if(0===s.children.length)return i;let t;const e=n.children,r=s.children;if(e.every((t=>void 0!==t.position))){if(t=e.every((t=>p(r,t.position,t).match)),t){const t=g(e).position;i.j=t>=0?t:r.length+t}}else for(let n=0;n<r.length;n++)if(t=e.every((t=>p(r,n,t).match)),t){i.j=n;break}if(!1===t)return i}else switch(typeof n[t]){case"boolean":case"number":case"string":if(s[t]!==n[t])return i;break;case"function":if(!n[t](s[t]))return i;break;case"object":if(d(n[t])){if(!1===n[t].every((e=>e(s[t]))))return i;break}default:throw new Error(`Unknown type of pattern test (key: ${t}). Test should be of type boolean, number, string, function or array of functions.`)}}return i.match=!0,i}function m(t){return Array.isArray(t)&&t.length&&t.every((t=>"object"==typeof t))}function d(t){return Array.isArray(t)&&t.length&&t.every((t=>"function"==typeof t))}function g(t){return t.slice(-1)[0]||{}}export{h as default};
//# sourceMappingURL=/sm/83d878e1075140468d8d25a9f7e5aa7d3eb3f99864370ee24fe25b6fa473b409.map